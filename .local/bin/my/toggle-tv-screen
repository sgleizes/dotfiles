#!/bin/bash
set -e

if ! command -v kscreen-doctor &>/dev/null; then
  echo "!! kscreen-doctor is not available"
  exit 2
fi

if [[ $(kscreen-doctor -j | jq '.outputs[] | select(.name=="HDMI-0") | .enabled') == false ]]; then
  mode=$(kscreen-doctor -j | jq -r '.outputs[] | select(.name=="HDMI-0") | .preferredModes[0]')
  kscreen-doctor output.HDMI-0.enable output.HDMI-0.mode."$mode" output.DP-1.position.1920,0
else
  kscreen-doctor output.HDMI-0.disable
fi
